<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>How To: Requesting Clearinghouse Data • theHUB</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How To: Requesting Clearinghouse Data">
<!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-0ZQ7494RM2"></script><script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date());
gtag('config', 'G-0ZQ7494RM2'); </script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">theHUB</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2025.01.08</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-pagroup" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">PAGroup</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-pagroup">
<li><a class="dropdown-item" href="../articles/web_only/PAG_About.html">About</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/PAG_GroupMeetings.html">Group Meetings</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/PAG_GuidelinesAndPolicies.html">Guidelines &amp; Policies</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/PAG_ProfessionalDevelopment.html">Professional Development</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/PAG_HowILikeToBeMentored.html">How I Like to be Mentored</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/PAG_Onboarding.html">Onboarding</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/PAG_Lexicon.html">Lexicon</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Advanced Candidate Evaluation (ACE)</h6></li>
    <li><a class="dropdown-item" href="../articles/AdvancedCandidateEvaluation.html">ACE - Overview</a></li>
    <li><a class="dropdown-item" href="../articles/AdvancedCandidateEvaluation_questions.html">ACE - Base Questions</a></li>
    <li><a class="dropdown-item" href="../articles/AdvancedCandidateEvaluation_setup.html">ACE - Setup</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>GeoCoding</h6></li>
    <li><a class="dropdown-item" href="../articles/GeoCoding_DownloadShapeFiles.html">Downloading Shape Files</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>General</h6></li>
    <li><a class="dropdown-item" href="../articles/HowTo_Software.html">Our Software Stack</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-datasets" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Datasets</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-datasets">
<li><a class="dropdown-item" href="../articles/Datasets_PubliclyAvailable.html">Publicly Available Datasets</a></li>
    <li><a class="dropdown-item" href="../articles/Datasets_CountryCurrency.html">Country and Currency Dataset</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-msuedw" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">MSUEDW</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-msuedw">
<li><a class="dropdown-item" href="../articles/EDW_dBeaverSetup.html">dBeaver Setup</a></li>
    <li><a class="dropdown-item" href="../articles/EDW_R-SQLsetup.html">R-SQL Setup</a></li>
    <li><a class="dropdown-item" href="../articles/EDW_Navigation.html">EDW Navigation</a></li>
    <li><a class="dropdown-item" href="../articles/EDW_SQLsnippetLibrary.html">SQL Snippet Library (In Progress)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/emilioxavier/theHUB/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://bsky.app/profile/exesposito.bsky.social" aria-label="Bluesky"><span class="fa fa-bluesky"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>How To: Requesting Clearinghouse Data</h1>
            
            <h4 data-toc-skip class="date">Updated 15/Mar/2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/emilioxavier/theHUB/blob/main/vignettes/HowTo_ClearinghouseData.Rmd" class="external-link"><code>vignettes/HowTo_ClearinghouseData.Rmd</code></a></small>
      <div class="d-none name"><code>HowTo_ClearinghouseData.Rmd</code></div>
    </div>

    
    
<hr>
<div class="section level3">
<h3 id="ferpa-disclaimer-statement">FERPA Disclaimer Statement<a class="anchor" aria-label="anchor" href="#ferpa-disclaimer-statement"></a>
</h3>
<blockquote>
<p><strong>IMPORTANT NOTE</strong>: You are solely responsible for the
maintenance of the confidentiality of this information as established in
the Family Educational Rights and Privacy Act (FERPA) and Michigan State
University Guidelines Governing Privacy and Release of Student
Records.</p>
</blockquote>
<hr>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The collecting and formatting of information to send to Clearinghouse
is often seen as a daunting task with little room for error. This
document is designed to help streamline the process through a
standardized workflow.</p>
</div>
<div class="section level2">
<h2 id="format-of-the-data-file">Format of the Data File<a class="anchor" aria-label="anchor" href="#format-of-the-data-file"></a>
</h2>
<p>All provided data <strong>must be</strong> of type text. While there
does not appear to be a preference on if the data request is provided as
a CSV file or Excel workbook, both are written.</p>
<div class="section level3">
<h3 id="header">Header<a class="anchor" aria-label="anchor" href="#header"></a>
</h3>
<p>The first row of the data request file contains the following
information. The <strong>bolded Information</strong> within the header
is static and should be the same for all requests.</p>
<table class="table">
<colgroup>
<col width="28%">
<col width="46%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th align="center">Column</th>
<th align="center">Information</th>
<th align="left">Notes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">A</td>
<td align="center"><strong>HI</strong></td>
<td align="left">Capital HI</td>
</tr>
<tr class="even">
<td align="center">B</td>
<td align="center"><strong>######</strong></td>
<td align="left">Institution code (six digit code)</td>
</tr>
<tr class="odd">
<td align="center">C</td>
<td align="center"><strong>##</strong></td>
<td align="left">Branch code (two digit code). If no branch, double
zeros</td>
</tr>
<tr class="even">
<td align="center">D</td>
<td align="center"><strong>Institution Name</strong></td>
<td align="left">Official full name of the institution</td>
</tr>
<tr class="odd">
<td align="center">E</td>
<td align="center"><code>YYYYMMDD</code></td>
<td align="left">File creation date</td>
</tr>
<tr class="even">
<td align="center">F</td>
<td align="center"><code>Search type</code></td>
<td align="left">
<code>SE</code><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;code&gt;SE&lt;/code&gt; for current or previously enrolled
students/transfers out (used for IPEDS)&lt;/p&gt;"><sup>1</sup></a> or <code>CO</code><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;code&gt;CO&lt;/code&gt; for &lt;strong&gt;Co&lt;/strong&gt;hort query (used
for SAM)&lt;/p&gt;"><sup>2</sup></a>
</td>
</tr>
<tr class="odd">
<td align="center">G</td>
<td align="center"><strong>I</strong></td>
<td align="left">Capital I</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="required-data">Required Data<a class="anchor" aria-label="anchor" href="#required-data"></a>
</h3>
<p>The data of interest starts on the second row and has the following
format.</p>
<table class="table">
<colgroup>
<col width="23%">
<col width="17%">
<col width="17%">
<col width="20%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th align="center">Column</th>
<th align="center">Name</th>
<th align="center">Type</th>
<th align="left">Value</th>
<th align="left">Notes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">A</td>
<td align="center">D1.col</td>
<td align="center">Text</td>
<td align="left">D1</td>
<td align="left">Literal value - “D1” in this field</td>
</tr>
<tr class="even">
<td align="center">B</td>
<td align="center">blank.1</td>
<td align="center">Text</td>
<td align="left">” ”</td>
<td align="left">Leave blank unless querying Pending Admission</td>
</tr>
<tr class="odd">
<td align="center">C</td>
<td align="center">first.name</td>
<td align="center">Text</td>
<td align="left">Student’s first name</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="center">D</td>
<td align="center">middle.initial</td>
<td align="center">Text</td>
<td align="left">Student’s iddle initial</td>
<td align="left">1 character only, no period</td>
</tr>
<tr class="odd">
<td align="center">E</td>
<td align="center">last.name</td>
<td align="center">Text</td>
<td align="left">Student’s last name</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="center">F</td>
<td align="center">suffix</td>
<td align="center">Text</td>
<td align="left">Student’s last name suffix</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="center">G</td>
<td align="center">DoB</td>
<td align="center">Text</td>
<td align="left">Student’s date of birth</td>
<td align="left">YYYYMMDD format</td>
</tr>
<tr class="even">
<td align="center">H</td>
<td align="center">search.date</td>
<td align="center">Text</td>
<td align="left">Search begin date</td>
<td align="left">YYYYMMDD format; use in conjunction with search
type</td>
</tr>
<tr class="odd">
<td align="center">I</td>
<td align="center">blank.2</td>
<td align="center">Text</td>
<td align="left">” ”</td>
<td align="left">Leave blank</td>
</tr>
<tr class="even">
<td align="center">J</td>
<td align="center">institution.code</td>
<td align="center">Text</td>
<td align="left">002290</td>
<td align="left">MSU’s code</td>
</tr>
<tr class="odd">
<td align="center">K</td>
<td align="center">branch.code</td>
<td align="center">Text</td>
<td align="left">00</td>
<td align="left">Branch code (we don’t have one); enter as “00”</td>
</tr>
<tr class="even">
<td align="center">L</td>
<td align="center">ID.number</td>
<td align="center">Text</td>
<td align="left">Student’s PID/EMPLID</td>
<td align="left"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="obtaining-data-from-msuedw">Obtaining Data from MSUEDW<a class="anchor" aria-label="anchor" href="#obtaining-data-from-msuedw"></a>
</h2>
<p>The following <code>R</code> commands provide the steps to assist the
construction of the Clearinghouse data request. Before using the
information below, please ensure the required R-SQL setup was completed.
The instructions on how to setup an <code>R</code> session to interact
with the MSUEDW is available in the <a href="https://thehopefulbox.com/articles/EDW_R-SQLsetup.html" class="external-link">EDW: R-SQL
Setup</a> article.</p>
<div class="section level3">
<h3 id="setup-the-r-session">Setup the <code>R</code> Session<a class="anchor" aria-label="anchor" href="#setup-the-r-session"></a>
</h3>
<p>The first step is setting up the <code>R</code> session by setting a
java parameter related to memory allocation and loading required
packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>java.parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-XX:+UseConcMarkSweepGC"</span>, <span class="st">"-Xmx8192m"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dbi.r-dbi.org" class="external-link">DBI</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.rforge.net/rJava/" class="external-link">rJava</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.rforge.net/RJDBC/" class="external-link">RJDBC</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://keyring.r-lib.org/" class="external-link">keyring</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="define-user-specified-variables">Define User-Specified Variables<a class="anchor" aria-label="anchor" href="#define-user-specified-variables"></a>
</h3>
<p>The user-defined variables provide easy modification of the script
for future Clearinghouse data requests. The available application types
are undergraduate (<code>UGRD</code>), graduate (<code>GRAD</code>),
human medicine (<code>HMED</code>), osteopathic medicine
(<code>OMED</code>), veternary medicine (<code>VMED</code>), agriculture
technology (<code>AGTC</code>), graduate certificate
(<code>GCRT</code>), law school (<code>LAW</code>), MSU law school
(<code>LAWM</code>), (<code>NON</code>), and (<code>NONL</code>). Notice
the format for the <code>search.start</code> and
<code>search.stop</code> dates. They are in the day-month-year
(DDMMYYYY; 01-aug-2021) format to accommodate SQL queries. The dates
will be transformed by the script for different portions of the data
request. The MSUEDW user name, institution name and code, branch code,
and search type are also set.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">application.type</span> <span class="op">&lt;-</span> <span class="st">"UGRD"</span></span>
<span><span class="va">search.start</span> <span class="op">&lt;-</span> <span class="st">"01-aug-2021"</span></span>
<span><span class="va">search.stop</span> <span class="op">&lt;-</span> <span class="st">"01-aug-2022"</span></span>
<span><span class="va">EDW.username</span> <span class="op">&lt;-</span> <span class="st">"emilio"</span></span>
<span></span>
<span><span class="va">institution.name</span> <span class="op">&lt;-</span> <span class="st">"Michigan State University"</span></span>
<span><span class="va">institution.code</span> <span class="op">&lt;-</span> <span class="st">"002290"</span></span>
<span><span class="va">branch.code</span> <span class="op">&lt;-</span> <span class="st">"00"</span></span>
<span><span class="va">search.type</span> <span class="op">&lt;-</span> <span class="st">"SE"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="setup-the-msuedw-connection">Setup the MSUEDW Connection<a class="anchor" aria-label="anchor" href="#setup-the-msuedw-connection"></a>
</h3>
<p>These commands will initiate a connection with the MSUEDW. Please
ensure the <code>classPath</code> matches your installation. The
<code>USERNAME</code> in
<code>"/Users/USERNAME/software/ojdbc11-full/ojdbc11.jar"</code> is a
placeholder. Please ensure the <code>classPath</code> is correct. For
more information, view the <a href="https://thehopefulbox.com/articles/EDW_R-SQLsetup.html" class="external-link">EDW: R-SQL
Setup</a> article.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jdbcDriver</span> <span class="op">&lt;-</span> <span class="fu">RJDBC</span><span class="fu">::</span><span class="fu">JDBC</span><span class="op">(</span>driverClass<span class="op">=</span><span class="st">"oracle.jdbc.OracleDriver"</span>, </span>
<span>                          classPath<span class="op">=</span><span class="st">"/Users/USERNAME/software/ojdbc11-full/ojdbc11.jar"</span><span class="op">)</span></span>
<span>                          </span>
<span><span class="va">MSUEDW.jdbc</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="va">jdbcDriver</span>, </span>
<span>                              <span class="st">"jdbc:oracle:thin:@//ebsprd390d.ais.msu.edu:1521/MSUEDW.EBSP.MSU.EDU"</span>,</span>
<span>                              <span class="va">EDW.username</span>, </span>
<span>                              <span class="fu">keyring</span><span class="fu">::</span><span class="fu">key_get</span><span class="op">(</span><span class="st">"MSUEDW"</span>, <span class="va">EDW.username</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="reformat-the-dates">Reformat the Dates<a class="anchor" aria-label="anchor" href="#reformat-the-dates"></a>
</h3>
<p>The dates of interest are constructed in the format needed by
Clearinghouse, and the date for the resulting Excel workbook and CSV
file are constructed.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">search.start.DT</span> <span class="op">&lt;-</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">dmy</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">search.start</span><span class="op">)</span></span>
<span><span class="va">search.start.yyyymmdd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">search.start.DT</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/formatc.html" class="external-link">formatC</a></span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">search.start.DT</span><span class="op">)</span>, flag<span class="op">=</span><span class="st">"0"</span>, width<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/formatc.html" class="external-link">formatC</a></span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html" class="external-link">day</a></span><span class="op">(</span><span class="va">search.start.DT</span><span class="op">)</span>, flag<span class="op">=</span><span class="st">"0"</span>, width<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">today.date</span> <span class="op">&lt;-</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html" class="external-link">today</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">file.date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">today.date</span><span class="op">)</span>, </span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/formatc.html" class="external-link">formatC</a></span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">today.date</span><span class="op">)</span>, flag<span class="op">=</span><span class="st">"0"</span>, width<span class="op">=</span><span class="fl">2</span><span class="op">)</span>, </span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/formatc.html" class="external-link">formatC</a></span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html" class="external-link">day</a></span><span class="op">(</span><span class="va">today.date</span><span class="op">)</span>, flag<span class="op">=</span><span class="st">"0"</span>, width<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="collect-the-data">Collect the Data<a class="anchor" aria-label="anchor" href="#collect-the-data"></a>
</h3>
<p>Clearinghouse uses the applicant’s full name and date of birth to
identify them within their comprehensive database. Three Tables/Views
within the MSUEDW contain the needed data to construct the Clearinghouse
data request. The <code>siscs.p_adm_appl_data_v</code> view contains
application data and contains several date columns related to the
submission of an application. The date columns are:</p>
<ul>
<li>ADM_CREATION_DT: application creation date</li>
<li>ADM_APPL_DT: application submission date</li>
<li>APPL_FEE_DT: application fee paid</li>
<li>ADM_APPL_CMPLT_DT: application completion date</li>
<li>ADM_UPDATED_DT: application last updated date</li>
</ul>
<p>The <code>siscs.p_names_v</code> view contains the applicant’s name,
and four name components are required. The column titles follow and are
self-explanatory.</p>
<ul>
<li>FIRST_NAME</li>
<li>MIDDLE_NAME</li>
<li>LAST_NAME</li>
<li>NAME_SUFFIX</li>
</ul>
<p>The applicant’s date of birth (column title BIRTHDATE) is obtained
from <code>siscs.p_person_v</code>.</p>
</div>
<div class="section level3">
<h3 id="construct-the-sql-queries">Construct the SQL Queries<a class="anchor" aria-label="anchor" href="#construct-the-sql-queries"></a>
</h3>
<p>The three SQL queries are constructed to include the noted dates of
interest. The application view (<code>p_adm_appl_data_v</code>) query
fetches applicants within the restricted time frame of the applications.
This example finds those that applied to MSU between 01/Aug/2021 and
01/Aug/2022 and equates to students starting in the fall/2022 semester.
The full name and date of birth queries include all individuals
(applicants and students) with the last updated dates since the first
day of the application query. The provided queries are general, and you
are encouraged to change them to fit your needs.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">apply.query</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"select *</span></span>
<span><span class="st"> from siscs.p_adm_appl_data_v</span></span>
<span><span class="st"> where ACAD_CAREER='"</span>, <span class="va">application.type</span>,</span>
<span>                     <span class="st">"' and ADM_CREATION_DT between '"</span>,</span>
<span>                     <span class="va">search.start</span>, <span class="st">"' and '"</span>, <span class="va">search.stop</span>, <span class="st">"'"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span></span>
<span><span class="va">name.query</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"select *</span></span>
<span><span class="st"> from siscs.p_names_v</span></span>
<span><span class="st"> where LASTUPDDTTM &gt;= '"</span>, <span class="va">search.start</span>, <span class="st">"'"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span> </span>
<span><span class="va">DoB.query</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"select *</span></span>
<span><span class="st"> from siscs.p_person_v</span></span>
<span><span class="st"> where LAST_CHILD_UPDDTM &gt;= '"</span>, <span class="va">search.start</span>, <span class="st">"'"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fetch-the-data">Fetch the Data<a class="anchor" aria-label="anchor" href="#fetch-the-data"></a>
</h3>
<p>The following commands send the query to the MSUEDW and fetch the
data. The fetched data is pared down to only include the columns of
interest and the most current entry retained for the full name.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## pull application data ----</span></span>
<span><span class="va">apply.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbSendQuery.html" class="external-link">dbSendQuery</a></span><span class="op">(</span><span class="va">MSUEDW.jdbc</span>, <span class="va">apply.query</span><span class="op">)</span></span>
<span><span class="va">apply.DATA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbFetch.html" class="external-link">dbFetch</a></span><span class="op">(</span><span class="va">apply.results</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">EMPLID</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">ends_with</a></span><span class="op">(</span><span class="st">"_DT"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## pull name data ----</span></span>
<span><span class="va">name.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbSendQuery.html" class="external-link">dbSendQuery</a></span><span class="op">(</span><span class="va">MSUEDW.jdbc</span>, <span class="va">name.query</span><span class="op">)</span></span>
<span><span class="va">name.DATA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbFetch.html" class="external-link">dbFetch</a></span><span class="op">(</span><span class="va">name.results</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">EMPLID</span>, <span class="va">NAME</span>, <span class="va">FIRST_NAME</span>, <span class="va">MIDDLE_NAME</span>, <span class="va">LAST_NAME</span>, <span class="va">NAME_SUFFIX</span>, <span class="va">LASTUPDDTTM</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">EMPLID</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">EMPLID</span>, <span class="va">LASTUPDDTTM</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">LASTUPDDTTM</span>, .keep_all<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## pull date-of-birth data ----</span></span>
<span><span class="va">DoB.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbSendQuery.html" class="external-link">dbSendQuery</a></span><span class="op">(</span><span class="va">MSUEDW.jdbc</span>, <span class="va">DoB.query</span><span class="op">)</span></span>
<span><span class="va">DoB.DATA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbFetch.html" class="external-link">dbFetch</a></span><span class="op">(</span><span class="va">DoB.results</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">EMPLID</span>, <span class="va">BIRTHDATE</span>, <span class="va">LAST_CHILD_UPDDTM</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## disconnect from the MSUEDW ----</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html" class="external-link">dbDisconnect</a></span><span class="op">(</span><span class="va">MSUEDW.jdbc</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="merge-the-data">Merge the Data<a class="anchor" aria-label="anchor" href="#merge-the-data"></a>
</h3>
<p>The three data sets are merged using the student ID
(<code>EMPLID</code>), where only those present in the application data
are retained.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combined.DATA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">apply.DATA</span>, y<span class="op">=</span><span class="va">name.DATA</span>,</span>
<span>          by<span class="op">=</span><span class="st">"EMPLID"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">DoB.DATA</span>,</span>
<span>            by<span class="op">=</span><span class="st">"EMPLID"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="create-first-row">Create First Row<a class="anchor" aria-label="anchor" href="#create-first-row"></a>
</h3>
<p>The first row is constructed based on the user-provided information
above.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first.row</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble_row</a></span><span class="op">(</span>D1.col<span class="op">=</span><span class="st">"HI"</span>,</span>
<span>                        blank.1<span class="op">=</span><span class="va">institution.code</span>,</span>
<span>                        first.name<span class="op">=</span><span class="va">branch.code</span>,</span>
<span>                        middle.initial<span class="op">=</span><span class="va">institution.name</span>,</span>
<span>                        last.name<span class="op">=</span><span class="va">file.date</span>,</span>
<span>                        suffix<span class="op">=</span><span class="va">search.type</span>,</span>
<span>                        DoB<span class="op">=</span><span class="st">"I"</span>,</span>
<span>                        search.date<span class="op">=</span><span class="st">""</span>,</span>
<span>                        blank.2<span class="op">=</span><span class="st">""</span>,</span>
<span>                        institution.code<span class="op">=</span><span class="st">""</span>,</span>
<span>                        branch.code<span class="op">=</span><span class="st">""</span>,</span>
<span>                        ID.number<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="format-the-data">Format the Data<a class="anchor" aria-label="anchor" href="#format-the-data"></a>
</h3>
<p>The data from the merge data is reformatted, and the data to be sent
to Clearinghouse is constructed.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Clearinghouse.DATA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>D1.col<span class="op">=</span><span class="st">"D1"</span>,</span>
<span>                             blank.1<span class="op">=</span><span class="st">""</span>,</span>
<span>                             first.name<span class="op">=</span><span class="va">combined.DATA</span><span class="op">$</span><span class="va">FIRST_NAME</span>,</span>
<span>                             middle.initial<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">combined.DATA</span><span class="op">$</span><span class="va">MIDDLE_NAME</span>, start<span class="op">=</span><span class="fl">1</span>, stop<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>                             last.name<span class="op">=</span><span class="va">combined.DATA</span><span class="op">$</span><span class="va">LAST_NAME</span>,</span>
<span>                             suffix<span class="op">=</span><span class="va">combined.DATA</span><span class="op">$</span><span class="va">NAME_SUFFIX</span>,</span>
<span>                             DoB<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">combined.DATA</span><span class="op">$</span><span class="va">BIRTHDATE</span><span class="op">)</span>,</span>
<span>                                        <span class="fu"><a href="https://rdrr.io/r/base/formatc.html" class="external-link">formatC</a></span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">combined.DATA</span><span class="op">$</span><span class="va">BIRTHDATE</span><span class="op">)</span>, flag<span class="op">=</span><span class="st">"0"</span>, width<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                                        <span class="fu"><a href="https://rdrr.io/r/base/formatc.html" class="external-link">formatC</a></span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html" class="external-link">day</a></span><span class="op">(</span><span class="va">combined.DATA</span><span class="op">$</span><span class="va">BIRTHDATE</span><span class="op">)</span>, flag<span class="op">=</span><span class="st">"0"</span>, width<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                             search.date<span class="op">=</span><span class="va">search.start.yyyymmdd</span>,</span>
<span>                             blank.2<span class="op">=</span><span class="st">""</span>,</span>
<span>                             institution.code<span class="op">=</span><span class="va">institution.code</span>,</span>
<span>                             branch.code<span class="op">=</span><span class="va">branch.code</span>,</span>
<span>                             ID.number<span class="op">=</span><span class="va">combined.DATA</span><span class="op">$</span><span class="va">EMPLID</span></span>
<span>                             <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span>.keep_all<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>                             </span>
<span><span class="va">export.DATA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">first.row</span>,</span>
<span>                         <span class="va">Clearinghouse.DATA</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="create-file-names">Create File Names<a class="anchor" aria-label="anchor" href="#create-file-names"></a>
</h3>
<p>The file names are constructed to make exporting the data easier.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filename.date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">today</span>, label<span class="op">=</span><span class="cn">TRUE</span>, abbr<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/formatc.html" class="external-link">formatC</a></span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html" class="external-link">day</a></span><span class="op">(</span><span class="va">today.date</span><span class="op">)</span>, flag<span class="op">=</span><span class="st">"0"</span>, width<span class="op">=</span><span class="fl">2</span><span class="op">)</span>, </span>
<span>                        <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">today.date</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xlsx.filename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Clearinghouse_data_request_"</span>, <span class="va">filename.date</span>, <span class="st">".xlsx"</span><span class="op">)</span></span>
<span><span class="va">csv.filename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Clearinghouse_data_request_"</span>, <span class="va">filename.date</span>, <span class="st">".csv"</span><span class="op">)</span></span>
<span><span class="va">RData.filename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Clearinghouse_data_request_"</span>, <span class="va">filename.date</span>, <span class="st">".RData"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="export-the-data">Export the Data<a class="anchor" aria-label="anchor" href="#export-the-data"></a>
</h3>
<p>The Clearinghouse data is exported as an Excel workbook and a CSV
file.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">WriteXLS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/WriteXLS/man/WriteXLS.html" class="external-link">WriteXLS</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">export.DATA</span>,</span>
<span>                   ExcelFileName<span class="op">=</span><span class="va">xlsx.filename</span>,</span>
<span>                   SheetNames<span class="op">=</span><span class="st">"RequestDATA"</span>,</span>
<span>                   colnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">export.DATA</span>,</span>
<span>         file<span class="op">=</span><span class="va">csv.filename</span>,</span>
<span>         row.names<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>         col.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Emilio Xavier Esposito.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
